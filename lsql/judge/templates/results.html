{% extends "base_menu.html" %}
{% load static %}
{% block contenido %}

<!--<script src="{% static 'judge/js/result.js' %}">></script> -->
<script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>

<h2 style="text-align:center">Colecci√≥n: {{collection.name_html|safe}}</h2>
<div style="display:flex;justify-content:between">
    <p style="font-size:20px">Grupo:</p>
     <form method="get" action="{% url 'judge:result' collection.id %}">
    <select style="margin-left:3%" name="clase" id="clase" onchange="this.parentNode.submit()">
      <option id = "{{group0.name}}" value="{{group0.id}}"> {{group0.name}} </option>
        {% for group in groups %}
            <option id = "{{group.name}}" value="{{group.id}}"> {{group.name}} </option>
        {% endfor %}
</select>
   </form>

<div class="col md-3">
    <button title="Leyenda" data-target="#exampleModal" data-toggle="modal" type="button" style="background-color:white;border:none;float:right"><i class="far fa-question-circle fa-2x"></i></button>

</div>
</div>


    <!-- Trigger the modal with a button -->
<!-- Button trigger modal -->


<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header d-block">
        <h5 class="modal-title text-center" id="exampleModalLabel">LEYENDA</h5>
      </div>
      <div class="modal-body">
        <span class="badge rounded-pill bg-primary">Primary</span><br>
          <span class="badge rounded-pill bg-secondary">Secondary</span><br>
        <span class="badge rounded-pill bg-success">Success</span><br>
        <span class="badge rounded-pill bg-danger">Danger</span><br>
        <span class="badge rounded-pill bg-warning text-dark">Warning</span><br>
        <span class="badge rounded-pill bg-info text-dark">Info</span><br>
        <span class="badge rounded-pill bg-light text-dark">Light</span><br>
        <span class="badge rounded-pill bg-dark">Dark</span>
      </div>
      <div class="modal-footer d-flex justify-content-center">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>
<table style="text-align:center;border: black 1px solid" class="table">
    <thead class="thead-dark">
      <tr>
          <th scope="col" style="border: solid black 1px" width="3%">Pos</th>
          <th scope="col" style="border: solid black 1px" width="10%">Usuarios</th>
          {% for p in collection.problem_list %}
             <th scope="col" style="border: solid black 1px" >
                 <a style="color:white" title="{{ p.title_html|safe }}" href="{% url 'judge:problem' p.pk %}">EJ{{forloop.counter}}</a>
             </th>
          {% endfor %}
          <th scope="col" style="border: solid black 1px" width="3%">Intentos</th>
          <th scope="col" style="border: solid black 1px" width="3%">Resueltos</th>
      </tr>
    </thead>
    <tbody>
    {% for p in users %}
    <tr style="color:black">
        {% if p == login %}
         <td class="bg-info" style=" border: black 1px solid;">{{forloop.counter}}</td>
         <td style="border: black 1px solid;">
          {{p.username}}
         </td>
        {% elif p.is_staff %}
         <td style="background-color:gray; border: black 1px solid;">{{forloop.counter}}</td>
         <td style="border: black 1px solid;">
          {{p.username}}
         </td>
        {%else%}
          <td style="border: black 1px solid;">{{forloop.counter}}</td>
          <td style="border: black 1px solid;">
          {{p.username}}
         </td>
        {% endif %}

          {% for pp in collection.problem_list %}
                {% if pp.solved %}
                    {% if p == login %}
                         <td class="bg-success" style="border: black 1px solid;">
                                  <form method="get" action="{% url 'judge:submissions' %}">
                            <input type="hidden" value="{{pp.id}}" name="id_problem">
                           <a onclick="this.parentNode.submit();" href="#" style="color:black; text-decoration: none;">{{ pp.num_submissions }}</a>
                       </form>
                        </td>
                    {% else %}
                        <td class="bg-success" style="border: black 1px solid;">{{ pp.num_submissions }}</td>
                    {% endif%}
                {% elif not pp.solved and pp.num_submissions > 0 %}
                     {% if p == login %}
                       <td class="bg-danger" style="border: black 1px solid;">
                            <form method="get" action="{% url 'judge:submissions' %}">
                                <input type="hidden" value="{{pp.id}}" name="id_problem">
                               <a onclick="this.parentNode.submit();" href="#" style="color:black; text-decoration: none;">{{ pp.num_submissions }}</a>
                           </form>
                       </td>
                     {%else%}
                         <td class="bg-danger" style="border: black 1px solid;">{{ pp.num_submissions }}</td>
                     {% endif %}
                {%else%}
                    {% if p == login %}
                          <td style="border: black 1px solid;"><a href="#" style="color:black; text-decoration: none;">{{ pp.num_submissions }}</a></td>
                     {%else%}
                          <td style="border: black 1px solid;">{{ pp.num_submissions }}</td>
                     {% endif %}
                {% endif %}

          {% endfor %}
        <td style="border: black 1px solid;">
            200
        </td>
        <td style="border: black 1px solid;">
            200
        </td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
<script>
$('#myModal').on('shown.bs.modal', function () {
  $('#myInput').trigger('focus')
})
</script>
{% endblock %}